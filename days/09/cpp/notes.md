Another delightful problem, and one related to image processing on top! I was initially a little disappointed that part 2 didn't require actually determining the boundaries between basins, but it still was a lot of fun.
