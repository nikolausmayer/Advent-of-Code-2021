This day broke me.

Major kudos to @fogleman without whose solution (its cleverness still eludes me) I would just have given up on my A-star idea before progressing into fruitful territory.

My C++ for this problem sucks and my solution is slow. I do not care. This day is evil.
